<h2 mat-dialog-title>Création de la section</h2>

<mat-dialog-content class="mat-typography" style="max-width:600px">
  <form #s="ngForm">
    <mat-form-field appearance="outline" class="w-100">
      <mat-label>Nom de la section</mat-label>
      <input
        matInput
        name="titre"
        [(ngModel)]="localSection.titre"
        required
        placeholder="Entrez le titre"
      />
    </mat-form-field>
  </form>

  <button
    mat-button
    color="primary"
    class="mt-3"
    (click)="addQuestion()"
  >
    <mat-icon>add</mat-icon>
    Ajouter une question
  </button>

  <div
    *ngFor="let q of questions; let i = index"
    class="question-block mat-elevation-z1 mt-3 p-3"
  >
    <h4>Question {{ i + 1 }}</h4>

    <mat-form-field appearance="outline" class="w-100 mt-2">
      <mat-label>Texte</mat-label>
      <input
        matInput
        name="texte{{i}}"
        [(ngModel)]="q.texte"
        required
        placeholder="Intitulé"
      />
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-100 mt-2">
      <mat-label>Date</mat-label>
      <input
        matInput
        type="date"
        name="date{{i}}"
        [(ngModel)]="q.date"
        required
      />
    </mat-form-field>

    <mat-checkbox
      class="mt-2"
      name="obligatoire{{i}}"
      [(ngModel)]="q.obligatoire"
    >
      Obligatoire
    </mat-checkbox>

    <mat-form-field appearance="outline" class="w-100 mt-2">
      <mat-label>Type</mat-label>
      <mat-select
        name="type{{i}}"
        [(ngModel)]="q.inputType"
        required
      >
        <mat-option *ngFor="let t of inputTypes" [value]="t">{{ t }}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-100 mt-2">
      <mat-label>Score (0–5)</mat-label>
      <input
        matInput
        type="number"
        name="score{{i}}"
        [(ngModel)]="q.score"
        min="0"
        max="5"
        required
      />
    </mat-form-field>

    <button
      mat-icon-button
      color="warn"
      class="mt-2"
      (click)="removeQuestion(i)"
    >
      <mat-icon>delete</mat-icon>
    </button>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end" class="pt-0">
  <button
    mat-flat-button
    color="primary"
    [disabled]="s.invalid"
    (click)="finish()"
  >
    Enregistrer
  </button>
  <button mat-stroked-button color="warn" (click)="cancel()">
    Annuler
  </button>
</mat-dialog-actions>
